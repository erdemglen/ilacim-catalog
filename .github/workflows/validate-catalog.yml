name: Validate Catalog JSON

on:
  push:
    branches: [ main ]
  pull_request:

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20

      - name: Validate medications_catalog.json against schema
        run: npx --yes ajv-cli@5.0.0 validate -s schema/catalog.schema.json -d medications_catalog.json --strict=true

      - name: Count entries (sanity check)
        run: |
          node -e "const fs=require('fs');const p='medications_catalog.json';const d=JSON.parse(fs.readFileSync(p,'utf8'));const n=Array.isArray(d)?d.length:0;console.log('Entries:', n); if(!Array.isArray(d) || n < 100){console.warn('Warning: entry count seems low');}"
